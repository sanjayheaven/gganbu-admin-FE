import{d as k,u as S,b as F,a as p,c as w,F as O,T as _}from"./filterAction.400baede.js";import{i as m,u as T,a as o,b9 as E,j as t,aD as M,b as v,I as g,bh as L,bi as U,ae as j,ba as q}from"./index.c7e7eff0.js";import{u as z,a as H}from"./index.e2d83f2b.js";import{u as K,C as b}from"./index.b9a1a2c1.js";const $=e=>m.get("/roles/getRoles",{params:e}),B=e=>m.post("/roles/createRole",e),Q=(e,l)=>m.post("/roles/updateRole",{roleId:e,...l}),W=e=>m.post("/roles/deleteRole",{roleId:e});function G({selectedItem:e,setSelectedItem:l,...n}){const{t:c}=T();return o(E,{...n,className:"min-w-max",children:[t(M,{labelCol:{span:3},children:v([{label:c("NAME"),required:!0,children:t(g,{value:e.name,onChange:r=>l({...e,name:r.target.value})})},{label:c("DESC"),required:!0,children:t(g.TextArea,{value:e.desc,onChange:r=>l({...e,desc:r.target.value})})}])}),o("div",{className:" grid grid-cols-3 mt-5 gap-4 ",children:[t("div",{className:"text-lg font-bold ",children:c("role.ROUTE_AUTH")}),t("div",{className:"text-lg font-bold ",children:c("role.CONTENT_AUTH")})]}),o("div",{className:"grid grid-cols-3 mt-5 gap-4 max-h-[40vh] overflow-auto",children:[t(k,{onCheck:r=>l({...e,routeAuth:r}),checkedKeys:e.routeAuth,fieldNames:{key:"path"},checkable:!0,treeData:L}),t("div",{})]})]})}function Z(){const{filter:e,setFilter:l}=S({}),{pagination:n,setPagination:c}=F(),{selectedItem:r,setSelectedItem:h}=z({}),{modal:u,setModal:f}=H({}),{data:x,setData:R}=p([]),{loading:y,setLoading:C}=K(!1),{t:s}=T(),d=async a=>{C(!0);try{const i=await $({...e,current:(a==null?void 0:a.current)||n.current,pageSize:(a==null?void 0:a.pageSize)||n.pageSize}),{items:N=[],total:I}=i;C(!1),R(N),c({...n,...a||{},total:I})}catch{}},A=async()=>{const{name:a}=r;if(!a)return q.error("Please finish all required info");try{r._id?await Q(r._id,r):await B(r),f({...u,open:!1}),await d()}catch{}};w(e,()=>d({...n,current:1}));const D=[{title:s("NAME"),dataIndex:"name"},{title:s("DESC"),dataIndex:"desc"},{title:s("role.STAFF_COUNT"),dataIndex:"staffCount"},{title:s("ACTION"),dataIndex:"action",render:(a,i)=>o(U,{children:[t("a",{onClick:()=>{h({...i}),f({...u,open:!0,title:s("EDIT")})},children:s("EDIT")}),t("a",{className:"text-red-600",onClick:()=>{E.confirm({content:"Sure to delete this item?",onOk:async()=>{try{await W(i._id),await d()}catch{}}})},children:s("DELETE")})]})}].map(a=>({...a,key:a.dataIndex}));return o("div",{children:[t(b,{className:"mb-4",children:o("div",{className:"grid grid-cols-4 gap-4",children:[v([{label:s("SEARCH"),className:"mb-0",children:t(g,{value:e.name,onChange:a=>l({...e,name:a.target.value}),placeholder:`${s("NAME")}/${s("DESC")}`})}]),t(O,{className:"mb-0",onQuery:()=>d(),onReset:()=>l({})})]})}),t(b,{title:o(j,{onClick:()=>{f({...u,title:s("ADD"),open:!0}),h({})},type:"primary",children:["+ ",s("role.NEW_ROLE")]}),children:t(_,{rowKey:a=>a._id,onChange:a=>d(a),pagination:n,loading:y,columns:D,dataSource:x})}),t(G,{selectedItem:r,setSelectedItem:h,...u,onOk:()=>A()})]})}export{Z as default};
//# sourceMappingURL=roleInfo.91b08ab3.js.map
